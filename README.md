# USBRegistrySweeper

**USBRegistrySweeper** — консольное приложение для работы с реестром Windows, позволяющее просматривать и очищать записи, связанные с USB-устройствами.

**Автор**: [d-k-dev](https://github.com/d-k-dev)  
**Версия**: 1.0.0  
**Дата**: 2025-02-20  

---

## Основные возможности

| Функция                        | Описание                                                                 |
|--------------------------------|--------------------------------------------------------------------------|
| **Просмотр истории USB**       | Отображает список подключённых устройств с датой последнего подключения  |
| **Сохранение истории**         | Экспортирует данные в файл `UsbHistory/[имя_ПК]/USBHistory_*.txt`        |
| **Очистка реестра**            | Удаляет записи из разделов `USBSTOR`, `USB`, `USBPRINT`                  |
| **Резервное копирование**      | Создаёт бэкапы реестра в `Backup/[имя_ПК]/*.reg` перед очисткой          |

---

## Скриншот

![](https://github.com/user-attachments/assets/cb080404-8f65-4913-ab0c-95d437277ffb)

---

## Использование PsExec

В **USBRegistrySweeper** используется **PsExec**, который уже включён в Release, для повышения привилегий до уровня системы. Это обеспечивает полный доступ к реестру Windows.

### Подробности:
- **Зачем нужен PsExec**: Некоторые записи реестра требуют прав SYSTEM, а не просто администратора.
- **Как работает**: Поскольку `psexec.exe` уже находится в папке с программой, она автоматически перезапускается с системными правами при запуске.
